@using System
@using System.Collections.Generic
@using System.Linq
@using System.Text
@using System.IO
@using RazorEngine
@using RazorEngine.Templating
@using Code4U.Models
@using Code4U.Helpers

@inherits RazorEngine.Templating.Code4UTemplateBase<Project>

@{ 
    var filename = Path.Combine(ViewBag.TemplateFolder, @"Mappings\__NAME__Map.cs.cshtml");

    foreach (var entity in Model.Entities)
    {
        var generatedCode = Include(filename, entity, typeof(Entity)).ToString();

        var generatedFileName = filename.Replace(ViewBag.TemplateFolder + "\\", string.Empty)
                                        .Replace("__NAME__", entity.Name)
                                        .Replace(".cshtml", string.Empty);

        generatedFileName = Path.Combine(ViewBag.GeneratedCodeFolder, generatedFileName);

        FileSystemHelper.WriteFile(generatedFileName, generatedCode);
    }
}
